#include <iostream>
#include <sstream>

using namespace std;
class Celda{
    public:
        Celda(int _x=0, int _y=0){
            x = _x; y = _y;
        }
        int valor=NULL, x, y;

        int setValue (int _valor){
            valor = _valor;
        }

        int getValue (){
            return valor;
        }

        int isKnown (){
            if (valor != NULL)
                return 0;
            else
                return 1;
        }
};

void solvePyramid (Celda pyr[][6]){
for (int a = 0; a < 5; ++a)             //Maximo que se tiene que recorrer la piramide para completarla
    for(int y = 0; y < 6; ++y)
        for(int x = 0; x <= y; ++x )
        {
            if (pyr[x][y].isKnown() == 0 && pyr[x+1][y].isKnown() == 0 && pyr[x][y-1].isKnown() == 1)
            {
                pyr[x][y-1].setValue(pyr[x][y].valor + pyr[x+1][y].valor);
            }
            else
            {
                if (pyr[x][y].isKnown() == 0 && pyr[x+1][y].isKnown() == 1 && pyr[x][y-1].isKnown() == 0)
                {
                    if ((pyr[x][y-1].valor - pyr[x][y].valor)>0)
                        pyr[x+1][y].setValue(pyr[x][y-1].valor - pyr[x][y].valor);
                    else
                        break;
                }
                else
                {
                    if (pyr[x][y].isKnown() == 1 && pyr[x+1][y].isKnown() == 0 && pyr[x][y-1].isKnown() == 0)
                    {
                        if ((pyr[x][y-1].valor - pyr[x+1][y].valor)>0)
                            pyr[x][y].setValue(pyr[x][y-1].valor - pyr[x+1][y].valor);
                        else
                            break;
                    }
                }
            }
        }
return;
}

int checkPyramid (Celda pyr[][6]){
int vm=0;
for(int y = 1; y < 6; ++y)
    for(int x = 0; x <= y; ++x ){
        if ((pyr[x][y].valor + pyr[x+1][y].valor) != pyr[x][y-1].valor)
            vm=1;
    }
return vm;
}

int CompletedPyramid (Celda pyr[][6]){
int verify=0;
for(int y = 0; y < 6; ++y)
    for(int x = 0; x <= y; ++x )
        if (pyr[x][y].isKnown()==1)
            verify=1;
return verify;
}


void showPyramid(Celda pyr[][6]){
stringstream ss;
for(int y = 0; y < 6; ++y){
        cout<<endl<<endl;
        for (int j=6; j>y; --j)
            cout<<"   ";
        for(int x = 0; x <= y; ++x )
            if (pyr[x][y].valor != NULL)
            {
                ss.width(6);
                ss << pyr[x][y].valor;
                cout << ss.str();
                ss.str("");
            }
            else
            {
                ss.width(6);
                ss << "()";
                cout << ss.str();
                ss.str("");
            }
}
cout<<endl;
}

int main()
{
    cout <<"---------------------------------------------------"<<endl<< "Piramide Inicial" << endl;
    Celda pyr[6][6];
    for(int y = 0; y < 6; y++)
        for(int x = 0; x <= y; x++ )
            pyr[x][y] = Celda(x,y);

    pyr[0][0].setValue (52);
    pyr[0][1].setValue (26);
    pyr[0][2].setValue (12);
    pyr[0][3].setValue (5);
    pyr[0][4].setValue (2);
    pyr[0][5].setValue (1);
    showPyramid(pyr);
    
cout<<"---------------------------------------------------"<<endl;

    solvePyramid(pyr);
    if (checkPyramid(pyr)==1 || CompletedPyramid(pyr)==1)
        cout << endl << "No se puede resolver";
    else
        showPyramid(pyr);
        
cout<<"---------------------------------------------------"<<endl;

    return 0;
}
